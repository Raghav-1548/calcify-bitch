<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calcify B!tch</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { 
  font-family: 'Poppins', sans-serif; 
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  min-height: 100vh;
  padding: 16px;
  color: #2d3748;
}
.container { 
  max-width: 720px; 
  margin: 0 auto; 
  background: #fff; 
  padding: 24px; 
  border-radius: 20px; 
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: slideIn 0.4s ease-out;
}
@keyframes slideIn {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}
h2 { 
  text-align: center; 
  margin-bottom: 24px; 
  font-weight: 700; 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 1.75rem;
  letter-spacing: -0.5px;
}
.input-group { 
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 20px;
}
.input-wrapper {
  position: relative;
  width: 100%;
}
.input-wrapper label {
  display: block;
  font-size: 11px;
  font-weight: 600;
  color: #718096;
  margin-bottom: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
input, select { 
  width: 100%; 
  padding: 12px 14px; 
  border: 2px solid #e2e8f0; 
  border-radius: 10px; 
  font-size: 14px;
  font-family: 'Poppins', sans-serif;
  transition: all 0.2s;
  background: #fff;
}
input:focus, select:focus { 
  border-color: #667eea; 
  outline: none; 
  box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
}
button { 
  padding: 14px 24px; 
  border: none; 
  border-radius: 10px; 
  cursor: pointer; 
  font-weight: 600; 
  font-size: 14px;
  font-family: 'Poppins', sans-serif;
  transition: all 0.2s;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  width: 100%;
}
button.primary { 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
  box-shadow: 0 4px 15px rgba(102,126,234,0.4);
}
button.primary:hover { 
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102,126,234,0.5);
}
button.primary:active {
  transform: translateY(0);
}
button.success { 
  background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
  color: #fff;
  box-shadow: 0 4px 15px rgba(72,187,120,0.3);
  margin-bottom: 12px;
}
button.success:hover { 
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(72,187,120,0.4);
}
button.delete { 
  background: #fc8181;
  color: #fff; 
  padding: 6px 14px; 
  font-size: 11px;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(252,129,129,0.3);
  width: auto;
}
button.delete:hover {
  background: #f56565;
  transform: scale(1.05);
}
.button-row {
  display: flex;
  flex-direction: column;
  gap: 0;
  margin-top: 20px;
}
.table-wrapper {
  width: 100%;
  overflow-x: auto;
  margin-top: 20px;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.05);
}
table { 
  width: 100%; 
  min-width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 13px;
}
thead {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
}
th { 
  padding: 14px 10px; 
  text-align: left; 
  font-weight: 600;
  text-transform: uppercase;
  font-size: 10px;
  letter-spacing: 0.5px;
  white-space: nowrap;
}
td { 
  padding: 14px 10px; 
  border-bottom: 1px solid #e2e8f0;
  background: #fff;
  font-size: 13px;
}
tbody tr {
  transition: all 0.2s;
}
tbody tr:hover {
  background: #f7fafc;
}
tbody tr:last-child td {
  border-bottom: none;
}
td:last-child { 
  text-align: center; 
}
.result { 
  margin-top: 24px; 
  background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
  padding: 20px; 
  border-radius: 14px;
  line-height: 1.8;
  font-size: 13px;
  border: 2px solid #e2e8f0;
  animation: fadeIn 0.3s ease-out;
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.result strong {
  color: #667eea;
  font-weight: 600;
}
.stat-card {
  background: #fff;
  padding: 14px;
  border-radius: 10px;
  margin: 8px 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.badge {
  display: inline-block;
  padding: 4px 10px;
  background: #667eea;
  color: #fff;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  margin-left: 8px;
}
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #a0aec0;
  font-size: 13px;
}
@media(min-width: 600px){
  .container {
    padding: 28px 32px;
  }
  .input-group {
    flex-direction: row;
    flex-wrap: wrap;
  }
  .input-wrapper {
    flex: 1;
    min-width: 180px;
  }
  .button-row {
    flex-direction: row;
  }
  button.success {
    margin-bottom: 0;
  }
  th {
    padding: 14px 14px;
    font-size: 11px;
  }
  td {
    padding: 14px 14px;
  }
}
</style>
</head>
<body>

<div class="container" id="setupContainer">
  <h2>ðŸš€ Calcify Setup</h2>
  <div class="input-group">
    <div class="input-wrapper">
      <label>Number of People</label>
      <input type="number" id="numPeople" placeholder="e.g., 4" min="2" />
    </div>
    <div class="input-wrapper">
      <label>Enter Names</label>
      <input type="text" id="namesInput" placeholder="John, Sarah, Mike, Emma" />
    </div>
  </div>
  <button class="primary" onclick="setupPeople()">Start Trip</button>
</div>

<div class="container" id="mainContainer" style="display:none;">
  <h2>ðŸ’° Calcify B!tch</h2>
  <div class="input-group">
    <div class="input-wrapper">
      <label>Who Paid?</label>
      <select id="personSelect"></select>
    </div>
    <div class="input-wrapper">
      <label>Purpose</label>
      <input type="text" id="purposeInput" placeholder="Lunch, Tickets, etc." />
    </div>
    <div class="input-wrapper">
      <label>Amount (â‚¹)</label>
      <input type="number" id="amountInput" placeholder="500" min="0" step="0.01" />
    </div>
  </div>
  <button class="primary" onclick="addExpense()">Add Expense</button>

  <div class="table-wrapper">
    <table id="expenseTable">
      <thead>
        <tr><th>Person</th><th>Purpose</th><th>Amount</th><th>Action</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="button-row">
    <button class="success" onclick="calculate('proportional')">Calculate Proportional</button>
    <button class="success" onclick="calculate('equal')">Calculate Equal Split</button>
  </div>

  <div class="result" id="result"></div>
</div>

<script>
let members = [];
const expenses = [];
function setupPeople() {
  const num = parseInt(document.getElementById('numPeople').value);
  const names = document.getElementById('namesInput').value.split(',').map(n=>n.trim()).filter(n=>n);
  if(!num || num < 2) return alert('Please enter at least 2 people');
  if(names.length !== num) return alert('Number of names does not match number of people');
  members = names;
  const select = document.getElementById('personSelect');
  select.innerHTML = '';
  members.forEach(m=>{ select.innerHTML += `<option value='${m}'>${m}</option>` });
  document.getElementById('setupContainer').style.display='none';
  document.getElementById('mainContainer').style.display='block';
}
function addExpense() {
  const person = document.getElementById('personSelect').value;
  const purpose = document.getElementById('purposeInput').value.trim();
  const amount = parseFloat(document.getElementById('amountInput').value);
  if (!amount || amount <= 0) return alert('Enter a valid amount');
  expenses.push({ person, purpose: purpose || 'Misc', amount });
  renderTable();
  document.getElementById('purposeInput').value = '';
  document.getElementById('amountInput').value = '';
}
function renderTable() {
  const tbody = document.querySelector('#expenseTable tbody');
  if(expenses.length === 0) {
    tbody.innerHTML = `<tr><td colspan="4" class="empty-state">No expenses added yet. Add your first expense above!</td></tr>`;
    return;
  }
  tbody.innerHTML = expenses.map((e,i)=>`<tr><td><strong>${e.person}</strong></td><td>${e.purpose}</td><td>â‚¹${e.amount.toFixed(2)}</td><td><button class='delete' onclick='deleteExpense(${i})'>Delete</button></td></tr>`).join('');
}
function deleteExpense(index) {
  expenses.splice(index,1);
  renderTable();
  document.getElementById('result').innerHTML='';
}
function calculate(type) {
  if(expenses.length===0) return alert('No expenses added');
  const totals = {};
  members.forEach(m=>totals[m]=0);
  expenses.forEach(e=>totals[e.person]+=e.amount);
  const total = Object.values(totals).reduce((a,b)=>a+b,0);
  const share = total/members.length;
  const balances = members.map(m=>({name:m,balance:+(totals[m]-share).toFixed(2)}));
  const creditors = balances.filter(b=>b.balance>0).sort((a,b)=>b.balance-a.balance);
  const debtors = balances.filter(b=>b.balance<0).sort((a,b)=>a.balance-b.balance);
  const settlements=[];
  if(type==='proportional'){
    let i=0,j=0;
    while(i<creditors.length && j<debtors.length){
      const c=creditors[i];
      const d=debtors[j];
      const amt=Math.min(c.balance,Math.abs(d.balance));
      settlements.push({from:d.name,to:c.name,amount:amt});
      c.balance-=amt;
      d.balance+=amt;
      if(Math.abs(c.balance)<0.01)i++;
      if(Math.abs(d.balance)<0.01)j++;
    }
  } else {
    const creditorNames=creditors.map(c=>c.name);
    debtors.forEach(d=>{
      const split=d.balance/creditorNames.length;
      creditorNames.forEach(cn=>{
        settlements.push({from:d.name,to:cn,amount:-split});
      });
    });
    let creditorTotals={};
    creditors.forEach(c=>creditorTotals[c.name]=c.balance);
    settlements.forEach(s=>{ creditorTotals[s.to]-=s.amount; });
    const overUnder=creditors.map(c=>({from:creditors[0].name,to:c.name,amount:creditorTotals[c.name]})).filter(x=>Math.abs(x.amount)>0.01);
    settlements.push(...overUnder);
  }
  let resultHTML=`<div class="stat-card"><strong>Total Expenses:</strong> <span class="badge">â‚¹${total.toFixed(2)}</span><br><strong>Per Person Share:</strong> <span class="badge">â‚¹${share.toFixed(2)}</span></div>`;
  resultHTML+=`<div class="stat-card"><strong>ðŸ’³ Individual Spending:</strong><br>`;
  resultHTML+=Object.entries(totals).map(([name,amt])=>`<div style="margin: 6px 0;">${name}: â‚¹${amt.toFixed(2)}</div>`).join('');
  resultHTML+=`</div><div class="stat-card"><strong>ðŸ’¸ Settlement Transactions:</strong><br>`;
  if(settlements.length===0){resultHTML+='<div style="color: #48bb78; font-weight: 600; margin-top: 8px;">âœ… All settled! Everyone is even.</div>';}
  else{ settlements.forEach(s=>{ if(s.amount>0)resultHTML+=`<div style="margin: 8px 0; padding: 8px; background: #fff7ed; border-left: 3px solid #f59e0b; border-radius: 4px;"><strong>${s.from}</strong> â†’ <strong>${s.to}</strong>: â‚¹${s.amount.toFixed(2)}</div>`; }); }
  resultHTML+=`</div>`;
  document.getElementById('result').innerHTML=resultHTML;
}
renderTable();
</script>
</body>
</html>
